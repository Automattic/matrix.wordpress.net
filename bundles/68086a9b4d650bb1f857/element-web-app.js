(self.webpackChunkelement_web=self.webpackChunkelement_web||[]).push([[400],{"./node_modules/matrix-react-sdk/src/components/views/auth/AuthHeaderLogo.tsx":(e,t,s)=>{"use strict";s.d(t,{c:()=>o});var r=s("./node_modules/react/index.js"),n=s("./node_modules/matrix-react-sdk/src/SdkConfig.ts");class o extends r.PureComponent{render(){var e;const t=n.cp.getObject("branding"),s=null!==(e=null==t?void 0:t.get("auth_header_logo_url"))&&void 0!==e?e:"themes/element/img/logos/element-logo.svg";return r.createElement("aside",{className:"mx_AuthHeaderLogo"},r.createElement("img",{src:s,alt:"Element"}))}}},"./node_modules/matrix-react-sdk/src/components/views/auth/AuthPage.tsx":(e,t,s)=>{"use strict";s.d(t,{c:()=>d});var r=s("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("./node_modules/react/index.js"),o=s("./node_modules/matrix-react-sdk/src/SdkConfig.ts"),a=s("./src/languageHandler.tsx");const i=()=>{var e;const t=o.cp.getObject("branding"),s=null!==(e=null==t?void 0:t.get("auth_footer_links"))&&void 0!==e?e:[{text:"Blog",url:"https://element.io/blog"},{text:"Twitter",url:"https://twitter.com/element_hq"},{text:"GitHub",url:"https://github.com/element-hq/element-web"}],r=[];for(const e of s)r.push(n.createElement("a",{href:e.url,key:e.text,target:"_blank",rel:"noreferrer noopener"},e.text));return n.createElement("footer",{className:"mx_AuthFooter",role:"contentinfo"},r,n.createElement("a",{href:"https://matrix.org",target:"_blank",rel:"noreferrer noopener"},(0,a._t)("powered_by_matrix")))};class d extends n.PureComponent{static getWelcomeBackgroundUrl(){if(d.welcomeBackgroundUrl)return d.welcomeBackgroundUrl;const e=o.cp.getObject("branding");d.welcomeBackgroundUrl="themes/element/img/backgrounds/lake.jpg";const t=null==e?void 0:e.get("welcome_background_url");if(t)if(Array.isArray(t)){const e=Math.floor(Math.random()*t.length);d.welcomeBackgroundUrl=t[e]}else d.welcomeBackgroundUrl=t;return d.welcomeBackgroundUrl}render(){const e={background:`center/cover fixed url(${d.getWelcomeBackgroundUrl()})`},t={position:"absolute",top:0,right:0,bottom:0,left:0,filter:"blur(40px)",background:e.background};return n.createElement("div",{className:"mx_AuthPage",style:e},n.createElement("div",{className:"mx_AuthPage_modal",style:{position:"relative",background:"initial"}},n.createElement("div",{className:"mx_AuthPage_modalBlur",style:t}),n.createElement("div",{className:"mx_AuthPage_modalContent",style:{display:"flex",zIndex:1,background:"rgba(255, 255, 255, 0.59)",borderRadius:"8px"}},this.props.children)),n.createElement(i,null))}}(0,r.c)(d,"welcomeBackgroundUrl",void 0)},"./src/vector/app.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{loadApp:()=>C});s("./node_modules/matrix-js-sdk/src/browser-index.ts");var r=s("./node_modules/react/index.js"),n=s("./node_modules/matrix-react-sdk/src/PlatformPeg.ts"),o=s("./node_modules/matrix-react-sdk/src/utils/AutoDiscoveryUtils.tsx"),a=s("./node_modules/matrix-js-sdk/src/autodiscovery.ts"),i=s("./node_modules/matrix-react-sdk/src/Lifecycle.ts"),d=s("./node_modules/matrix-react-sdk/src/SdkConfig.ts"),c=s("./node_modules/matrix-js-sdk/src/logger.ts"),l=s("./node_modules/matrix-js-sdk/src/matrix.ts"),m=s("./node_modules/matrix-react-sdk/src/utils/SnakedObject.ts"),f=s("./node_modules/matrix-react-sdk/src/components/structures/MatrixChat.tsx"),u=s("./node_modules/@matrix-org/react-sdk-module-api/lib/lifecycles/WrapperLifecycle.js"),g=s("./node_modules/matrix-react-sdk/src/modules/ModuleRunner.ts"),_=s("./src/vector/url_utils.ts");let x=null;function w(e){const t=(0,_.I)(e);return{screen:t.location.substring(1),params:t.params}}function h(){decodeURIComponent(window.location.hash)!==x&&function(e){if(!window.matrixChat)return;c.Q.log("Routing URL ",e.href);const t=w(e);window.matrixChat.showScreen(t.screen,t.params)}(window.location)}function k(e,t=!1){c.Q.log("newscreen "+e);const s="#/"+e;x=s,e.startsWith("room/")&&window.location.hash.includes("/$")===s.includes("/$")&&window.location.hash.startsWith(s)&&(t=!0),t?window.location.replace(s):window.location.assign(s)}const p="mx_screen_after_login";function v(e){const t=w(e);(t.screen||t.params)&&function(e){null!=e&&e.screen&&sessionStorage.setItem(p,JSON.stringify(e))}(t);const s=function(){const e=sessionStorage.getItem(p);return e?JSON.parse(e):void 0}();return s}var b=s("./src/languageHandler.tsx");function y(){const e=new URL(window.location.href);e.searchParams.delete("loginToken"),e.searchParams.delete("state"),e.searchParams.delete("code"),c.Q.log(`Redirecting to ${e.href} to drop delegated authentication params from queryparams`),window.history.replaceState(null,"",e.href)}async function C(e,t){var s;window.addEventListener("hashchange",h);const x=n.c.get(),p=(0,_.U)(window.location),C=window.location.protocol+"//"+window.location.host+window.location.pathname;c.Q.log("Vector starting at "+C),x.startUpdater();const U=await async function(){let e;try{c.Q.log("Verifying homeserver configuration");const t=d.cp.get();let s=t.default_server_config;const r=t.default_server_name,n=t.default_hs_url,i=t.default_is_url,l=[s,r,n].filter((e=>!!e));if(n&&(s||r))throw new b.S2("error|invalid_configuration_mixed_server");if(l.length<1)throw new b.S2("error|invalid_configuration_no_server");let m;n&&(c.Q.log("Config uses a default_hs_url - constructing a default_server_config using this information"),c.Q.warn("DEPRECATED CONFIG OPTION: In the future, default_hs_url will not be accepted. Please use default_server_config instead."),s={"m.homeserver":{base_url:n}},i&&(s["m.identity_server"]={base_url:i})),!r&&s&&(c.Q.log("Config uses a default_server_config - validating object"),m=await a.ic.fromDiscoveryConfig(s)),r&&(c.Q.log("Config uses a default_server_name - doing .well-known lookup"),c.Q.warn("DEPRECATED CONFIG OPTION: In the future, default_server_name will not be accepted. Please use default_server_config instead."),m=await a.ic.findClientConfig(r),null===m["m.homeserver"].base_url&&s&&(c.Q.log("Finding base_url failed but a default_server_config was found - using it as a fallback"),m=await a.ic.fromDiscoveryConfig(s))),e=o.c.buildValidatedConfigFromDiscovery(r,m,!0)}catch(t){const{hsUrl:s,isUrl:r,userId:n}=await i.S_();if(!s||!n)throw t;c.Q.error(t),c.Q.warn("A session was found - suppressing config error and using the session's homeserver"),c.Q.log("Using pre-existing hsUrl and isUrl: ",{hsUrl:s,isUrl:r}),e=await o.c.validateServerConfigWithStaticUrls(s,r,!0)}return e.isDefault=!0,c.Q.log("Using homeserver config:",e),c.Q.log("Updating SdkConfig with validated discovery information"),d.cp.add({validated_server_config:e}),d.cp.get()}(),E=new m.Y(U),[P]=await i.aU(),Q=!!P,S=!!p.loginToken,O=(0,d.QH)(U);let A=!0===O.immediate;const N="#/welcome"===window.location.hash||"#"===window.location.hash||""===window.location.hash;if(!A&&O.on_welcome_page&&N&&(A=!0),!Q&&!S&&A){c.Q.log("Bypassing app load to redirect to SSO");const e=(0,l.createClient)({baseUrl:U.validated_server_config.hsUrl,idBaseUrl:U.validated_server_config.isUrl});return n.c.get().startSingleSignOn(e,"sso",`/${w(window.location).screen}`),r.createElement(r.Fragment,null)}const j=null!==(s=E.get("default_device_display_name"))&&void 0!==s?s:null==x?void 0:x.getDefaultDeviceDisplayName(),D=v(window.location),I={Wrapper:r.Fragment};return g.m.instance.invoke(u.O.Wrapper,I),r.createElement(I.Wrapper,null,r.createElement(f.c,{ref:t,onNewScreen:k,config:U,realQueryParams:p,startingFragmentQueryParams:e,enableGuest:!U.disable_guests,onTokenLoginCompleted:y,initialScreenAfterLogin:D,defaultDeviceDisplayName:j}))}window.React=r,c.Q.log("Application is running in production mode"),window.matrixLogger=c.Q},"./node_modules/matrix-react-sdk/src/effects lazy recursive ^\\.\\/.*$ referencedExports: default":(e,t,s)=>{var r={"./":["./node_modules/matrix-react-sdk/src/effects/index.ts",9],"./ICanvasEffect":["./node_modules/matrix-react-sdk/src/effects/ICanvasEffect.ts",7,524],"./ICanvasEffect.ts":["./node_modules/matrix-react-sdk/src/effects/ICanvasEffect.ts",7,524],"./confetti":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,399],"./confetti/":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,399],"./confetti/index":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,399],"./confetti/index.ts":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,399],"./effect":["./node_modules/matrix-react-sdk/src/effects/effect.ts",9,124],"./effect.ts":["./node_modules/matrix-react-sdk/src/effects/effect.ts",9,124],"./fireworks":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,800],"./fireworks/":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,800],"./fireworks/index":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,800],"./fireworks/index.ts":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,800],"./hearts":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,719],"./hearts/":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,719],"./hearts/index":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,719],"./hearts/index.ts":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,719],"./index":["./node_modules/matrix-react-sdk/src/effects/index.ts",9],"./index.ts":["./node_modules/matrix-react-sdk/src/effects/index.ts",9],"./rainfall":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,792],"./rainfall/":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,792],"./rainfall/index":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,792],"./rainfall/index.ts":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,792],"./snowfall":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,868],"./snowfall/":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,868],"./snowfall/index":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,868],"./snowfall/index.ts":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,868],"./spaceinvaders":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,760],"./spaceinvaders/":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,760],"./spaceinvaders/index":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,760],"./spaceinvaders/index.ts":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,760],"./utils":["./node_modules/matrix-react-sdk/src/effects/utils.ts",9],"./utils.ts":["./node_modules/matrix-react-sdk/src/effects/utils.ts",9]};function n(e){if(!s.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],n=t[0];return Promise.all(t.slice(2).map(s.e)).then((()=>s.t(n,16|t[1])))}n.keys=()=>Object.keys(r),n.id="./node_modules/matrix-react-sdk/src/effects lazy recursive ^\\.\\/.*$ referencedExports: default",e.exports=n}}]);
//# sourceMappingURL=element-web-app.js.map